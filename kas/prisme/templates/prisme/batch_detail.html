{% extends 'kas/layout.html' %}
{% load i18n %}
{% block content %}

<div class="container">
    <h1>{{ batch }}</h1>

    <dl class="row">
    <dt class="col-sm-2">{% trans 'Oprettet' %}</dt>
    <dd class="col-sm-10">{{ batch.created|date:"SHORT_DATETIME_FORMAT" }}</dd>

    <dt class="col-sm-2">{% trans 'Status' %}</dt>
    <dd class="col-sm-10">{{ batch.get_status_display }}</dd>
    </dl>

    <div>
        <a href="{% url 'prisme:prisme-batch-download' pk=batch.pk %}" role="button" class="btn btn-primary">{% trans 'Hent fil' %}</a>
        {% if batch.status == batch_class.STATUS_CREATED %}
        <a href="#" role="button" class="btn btn-primary">{% trans 'Send til Prisme' %}</a>
        {% endif %}
    </div>

    <div class="my-3">
        <table class="table table-bordered table-sm">
            <thead>
            <tr>
                <th>{% trans 'Person' %}</th>
                <th>{% trans 'Slutopgørelse' %}</th>
                <th>{% trans 'Status' %}</th>
                <th>{% trans 'Oprettet' %}</th>
                <th>{% trans 'Beløb' %}</th>
            </tr>
            </thead>
            <tbody>
            {% for transaction in transactions %}
                {% with final_settlement=transaction.source_object person_tax_year=transaction.source_object.person_tax_year %}
                <tr>
                    <td><a href="{% url 'kas:person_in_year' person_tax_year.year person_tax_year.person.pk %}">{{ person_tax_year.person.name }}</a></td>
                    <td><a href="{% url 'kas:final_settlement_download' final_settlement.uuid %}">{% trans 'Vis slutopgørelse'%}</a></td>
                    <td>{{ transaction.get_status_display }}</td>
                    <td>{{ transaction.created_at|date:"SHORT_DATETIME_FORMAT" }}</td>
                    <td>{{ transaction.amount }}</td>
                </tr>
                {% endwith %}
            {% empty %}
                <tr>
                    <td colspan="{% if policy_col %}4{% else %}3{% endif %}">{% trans 'Ingen transaktioner fundet' %}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        {% include 'includes/pager.html' %}
    </div>
</div>

{% endblock %}
